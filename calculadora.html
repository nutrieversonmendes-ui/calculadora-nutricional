<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Nutricional Completa - Everson Mendes</title>
    <style>
        /* CSS para Estilização Profissional e Cores da Logo */
        :root {
            /* Definindo variáveis CSS para as cores da logo */
            --gradiente-inicio: #93D6B5; /* Verde/Ciano Claro da logo */
            --gradiente-fim: #58C27E;   /* Verde Vibrante da logo */
            --cor-primaria: #28A745;    /* Verde escuro para botões e destaques */
            --cor-primaria-hover: #1e8e3e; 
            --cor-texto-principal: #333;
            --cor-texto-secundario: #555;
            --cor-fundo-card: #ffffff;
            --cor-borda-input: #e0e0e0;
            --cor-fundo-resultado: #e9f7ee; 
            --sombra-card: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(to bottom right, var(--gradiente-inicio), var(--gradiente-fim));
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--cor-texto-principal);
            line-height: 1.6;
        }

        .container {
            max-width: 650px; 
            width: 95%;
            background: var(--cor-fundo-card);
            padding: 40px; 
            border-radius: 15px; 
            box-shadow: var(--sombra-card);
            text-align: center; 
        }

        .logo-container {
            margin-bottom: 30px; 
        }

        .logo-container img {
            max-width: 220px; 
            height: auto;
            display: block;
            margin: 0 auto;
        }

        h1 {
            color: var(--cor-texto-principal);
            font-size: 2em; 
            margin-bottom: 30px;
            font-weight: 700; 
        }
        
        h2 {
            color: var(--cor-primaria);
            font-size: 1.5em;
            font-weight: 700;
            border-bottom: 2px solid #eee;
            padding-bottom: 5px;
            margin-top: 25px;
            text-align: left;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 400; 
            color: var(--cor-texto-secundario);
            font-size: 0.95em;
        }

        input[type="number"], select {
            width: 100%;
            padding: 12px 15px; 
            border: 1px solid var(--cor-borda-input);
            border-radius: 8px; 
            box-sizing: border-box;
            font-size: 1em;
            color: var(--cor-texto-principal);
            background-color: #fcfcfc;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input[type="number"]:focus, select:focus {
            border-color: var(--cor-primaria);
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2); 
            outline: none;
        }

        /* Estilização para a seção de Unidades */
        #unidade-toggle {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        #unidade-toggle label {
            font-weight: normal;
            margin-left: 10px;
            cursor: pointer;
            color: var(--cor-primaria);
        }

        button {
            background-color: var(--cor-primaria);
            color: white;
            padding: 14px 25px; 
            border: none;
            border-radius: 8px; 
            cursor: pointer;
            width: 100%;
            font-size: 1.1em;
            font-weight: 700;
            margin-top: 25px;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            background-color: var(--cor-primaria-hover);
            transform: translateY(-2px); 
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        /* --- ESTILIZAÇÃO DA SEÇÃO DE RESULTADOS (Otimizada) --- */
        .resultado {
            margin-top: 35px;
            padding: 25px; 
            border-radius: 10px;
            background-color: var(--cor-fundo-resultado);
            border-left: 6px solid var(--cor-primaria); 
            text-align: left; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .resultado h2 {
            font-size: 1.4em;
            color: var(--cor-primaria);
            margin-bottom: 15px;
        }

        /* Estilo para as linhas de TMB e GET */
        .resultado-linha {
            margin: 8px 0;
            font-size: 1.05em;
            color: var(--cor-texto-principal);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px dashed #e0e0e0; /* Linha divisória sutil */
            padding-bottom: 8px;
        }
        
        /* Estilo para a linha final de Calorias (Destacada) */
        #linha-calorias-objetivo {
            margin-top: 15px;
            padding: 12px;
            background-color: #d1ffd6; /* Fundo de destaque mais claro */
            border-radius: 6px;
            font-weight: 700;
            border-bottom: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            font-size: 1.15em;
        }

        .valor-principal {
            color: var(--cor-primaria);
            font-weight: 700;
            font-size: 1.1em;
        }
        
        /* Estilo para o título de Macros */
        #macro-titulo-proporcao {
            font-size: 1.25em;
            font-weight: 700;
            margin-top: 20px;
            border-bottom: none;
            color: var(--cor-texto-secundario);
            text-align: center;
        }

        .macro-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
            text-align: center;
        }

        /* Estilo para as caixas de Macros */
        .macro-item {
            padding: 15px 10px;
            border: 2px solid var(--cor-primaria); /* Borda sólida */
            border-radius: 8px;
            background-color: var(--cor-fundo-card); /* Fundo branco ou claro */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .macro-item strong {
            font-size: 1.6em; /* Tamanho maior para o valor em gramas */
            color: var(--cor-primaria);
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }
        
        .macro-item span {
            display: block;
            font-size: 0.85em;
            color: var(--cor-texto-secundario);
        }

        .total-macros {
            text-align: right;
            margin-top: 15px;
            font-size: 0.95em;
            color: var(--cor-texto-secundario);
        }

        .disclaimer {
            font-size: 0.8em;
            color: #777;
            margin-top: 30px;
            text-align: center;
        }
        
        /* Responsividade básica */
        @media (max-width: 650px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .container {
                padding: 25px;
            }
            .macro-grid {
                grid-template-columns: 1fr;
            }
            .resultado-linha {
                display: block;
                text-align: left;
                padding-bottom: 10px;
            }
            .resultado-linha strong {
                display: inline-block;
                margin-left: 10px;
            }
        }
    </style>
    
</head>
<body>

<div class="container">
    <div class="logo-container">
        <img src="logo-everson-mendes-nova.png" alt="Everson Mendes Nutrição e Treinamento">
    </div>

    <h1>Calculadora Nutricional Completa</h1>

    <div id="unidade-toggle">
        <label>
            <input type="radio" name="unidade" value="metric" checked onchange="ajustarUnidades()"> Métrico (kg/cm)
        </label>
        <label>
            <input type="radio" name="unidade" value="imperial" onchange="ajustarUnidades()"> Imperial (lb/in)
        </label>
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="peso"><span id="label-peso">Peso (kg):</span></label>
            <input type="number" id="peso" placeholder="Ex: 75" min="1" required>
        </div>
        <div class="form-group">
            <label for="altura"><span id="label-altura">Altura (cm):</span></label>
            <input type="number" id="altura" placeholder="Ex: 175" min="1" required>
        </div>
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="idade">Idade (anos):</label>
            <input type="number" id="idade" placeholder="Ex: 30" min="1" required>
        </div>
        <div class="form-group">
            <label for="sexo">Sexo:</label>
            <select id="sexo" required>
                <option value="">Selecione</option>
                <option value="M">Masculino</option>
                <option value="F">Feminino</option>
            </select>
        </div>
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="percentualGordura">Percentual de Gordura Corporal (%GC) (Opcional):</label>
            <input type="number" id="percentualGordura" placeholder="Ex: 15" min="1" max="60">
        </div>
        <div class="form-group">
            <label for="atividade">Nível de Atividade Física:</label>
            <select id="atividade" required>
                <option value="">Selecione</option>
                <option value="SEDENTARIO">Sedentário</option>
                <option value="LEVE">Leve (1-3 dias/sem)</option>
                <option value="MODERADO">Moderado (3-5 dias/sem)</option>
                <option value="INTENSO">Intenso (6-7 dias/sem)</option>
                <option value="MUITO_INTENSO">Muito Intenso (2x ao dia)</option>
            </select>
        </div>
    </div>

    <div class="form-group">
        <label for="objetivo">Objetivo:</label>
        <select id="objetivo" required>
            <option value="">Selecione</option>
            <option value="MANUTENCAO">Manutenção (Não alterar peso)</option>
            <option value="PERDA_LEVE">Perda de Peso Leve (-300 kcal)</option>
            <option value="PERDA_MODERADA">Perda de Peso Moderada (-500 kcal)</option>
            <option value="GANHO_LEVE">Ganho de Massa Leve (+300 kcal)</option>
            <option value="GANHO_MODERADO">Ganho de Massa Moderado (+500 kcal)</option>
        </select>
    </div>

    <button onclick="realizarCalculo()">Calcular Informações Nutricionais</button>

    <div id="resultados" class="resultado" style="display: none;">
        <h2>Resumo Calórico e Plano</h2>
        
        <p class="resultado-linha">
            <span>TMB <span id="formula-tmb-usada"></span>:</span>
            <span class="valor-principal"><strong id="tmb-resultado"></strong> kcal/dia</span>
        </p>

        <p class="resultado-linha">
            <span>Gasto Energético Total (GET):</span>
            <span class="valor-principal"><strong id="get-resultado"></strong> kcal/dia</span>
        </p>

        <p id="linha-calorias-objetivo" class="resultado-linha">
            <span>Calorias para <span id="objetivo-texto-final"></span>:</span>
            <span class="valor-principal"><strong id="calorias-objetivo"></strong> kcal/dia</span>
        </p>

        <h2 id="macro-titulo-proporcao">Distribuição de Macronutrientes</h2>
        
        <div class="macro-grid">
            <div class="macro-item">
                <strong id="prot-gramas"></strong>g
                <span id="prot-perc-display">Proteínas (0%)</span>
            </div>
            <div class="macro-item">
                <strong id="carb-gramas"></strong>g
                <span id="carb-perc-display">Carboidratos (0%)</span>
            </div>
            <div class="macro-item">
                <strong id="gord-gramas"></strong>g
                <span id="gord-perc-display">Gorduras (0%)</span>
            </div>
        </div>
        
        <p class="total-macros">
             Total de Calorias dos Macros: <span id="macro-total-kcal"></span> kcal. 
        </p>
    </div>

    <p class="disclaimer">
        *Fórmulas: TMB (Katch-McArdle, se %GC informado, ou Mifflin-St Jeor) e GET (Fator de Atividade). Os cálculos e as proporções de macros são sugestões alinhadas à literatura e não substituem o plano personalizado de um profissional de saúde.
    </p>

</div>

<script>
    // --- VARIÁVEIS GLOBAIS DE CONVERSÃO E FATOR DE CÁLCULO ---
    const CONVERSAO_KG_LB = 2.20462;
    const CONVERSAO_IN_CM = 0.393701;
    const FATOR_CAL_PROT = 4;
    const FATOR_CAL_CARB = 4;
    const FATOR_CAL_GORD = 9;

    /** Calcula a Taxa de Metabolismo Basal (TMB) usando a Equação de Mifflin-St Jeor. */
    function calcularTMBMifflin(peso, altura, idade, sexo) {
        if (sexo.toUpperCase() === 'M') {
            return (10 * peso) + (6.25 * altura) - (5 * idade) + 5;
        } else {
            return (10 * peso) + (6.25 * altura) - (5 * idade) - 161;
        }
    }

    /** Calcula TMB usando a fórmula de Katch-McArdle (requer percentual de gordura). */
    function calcularTMBKatch(peso, percentualGordura) {
        if (percentualGordura <= 0 || percentualGordura >= 60) return 0; 
        
        const massaMagra = peso * (1 - (percentualGordura / 100));
        return 370 + (21.6 * massaMagra);
    }

    /** Calcula o Gasto Energético Total (GET) multiplicando a TMB pelo Fator de Atividade. */
    function calcularGET(tmb, nivelAtividade) {
        const fatores = {
            'SEDENTARIO': 1.2,
            'LEVE': 1.375,
            'MODERADO': 1.55,
            'INTENSO': 1.725,
            'MUITO_INTENSO': 1.9
        };
        const fatorAtividade = fatores[nivelAtividade.toUpperCase()];
        return tmb * (fatorAtividade || 1.2); 
    }

    /** Calcula as calorias para atingir o objetivo (déficit ou superávit). */
    function calcularCaloriasObjetivo(get, objetivo) {
        const ajustes = {
            'MANUTENCAO': 0,
            'PERDA_LEVE': -300,
            'PERDA_MODERADA': -500,
            'GANHO_LEVE': 300,
            'GANHO_MODERADA': 500
        };
        return get + (ajustes[objetivo.toUpperCase()] || 0);
    }

    /** Calcula a distribuição de Macronutrientes com base no objetivo. */
    function calcularMacronutrientes(caloriasObjetivo, objetivo) {
        let protPerc, carbPerc, gordPerc, macroProporcaoTexto;
        
        switch (objetivo.toUpperCase()) {
            case 'PERDA_LEVE':
            case 'PERDA_MODERADA':
                protPerc = 0.40; carbPerc = 0.30; gordPerc = 0.30; 
                macroProporcaoTexto = '40% Prot / 30% Carb / 30% Gord';
                break;
            case 'GANHO_LEVE':
            case 'GANHO_MODERADA':
                protPerc = 0.30; carbPerc = 0.50; gordPerc = 0.20;
                macroProporcaoTexto = '30% Prot / 50% Carb / 20% Gord';
                break;
            case 'MANUTENCAO':
            default:
                protPerc = 0.30; carbPerc = 0.40; gordPerc = 0.30;
                macroProporcaoTexto = '30% Prot / 40% Carb / 30% Gord';
                break;
        }

        const protKcal = caloriasObjetivo * protPerc;
        const carbKcal = caloriasObjetivo * carbPerc;
        const gordKcal = caloriasObjetivo * gordPerc;

        const protG = protKcal / FATOR_CAL_PROT;
        const carbG = carbKcal / FATOR_CAL_CARB;
        const gordG = gordKcal / FATOR_CAL_GORD;

        const totalKcal = protKcal + carbKcal + gordKcal;
        
        return {
            protG: Math.round(protG), carbG: Math.round(carbG), gordG: Math.round(gordG),
            protPerc: Math.round(protPerc * 100), carbPerc: Math.round(carbPerc * 100), gordPerc: Math.round(gordPerc * 100),
            totalKcal: Math.round(totalKcal),
            proporcaoTexto: macroProporcaoTexto
        };
    }
    
    /** Ajusta os rótulos de unidade na interface (Métrico/Imperial). */
    function ajustarUnidades() {
        const isMetric = document.querySelector('input[name="unidade"]:checked').value === 'metric';
        document.getElementById('label-peso').textContent = isMetric ? 'Peso (kg):' : 'Peso (lb):';
        document.getElementById('label-altura').textContent = isMetric ? 'Altura (cm):' : 'Altura (in):';
    }

    /** Mapeia o código do objetivo para um texto amigável. */
    function getTextoObjetivo(objetivo) {
        const textos = {
            'MANUTENCAO': 'Manutenção de Peso', 'PERDA_LEVE': 'Perda de Peso Leve', 
            'PERDA_MODERADA': 'Perda de Peso Moderada', 'GANHO_LEVE': 'Ganho de Massa Leve', 
            'GANHO_MODERADA': 'Ganho de Massa Moderado'
        };
        return textos[objetivo.toUpperCase()] || 'Objetivo Não Definido';
    }

    /** Função principal que coleta dados e exibe o resultado. */
    function realizarCalculo() {
        // Coleta e preparação de dados, garantindo que campos vazios sejam lidos como '0'
        const isMetric = document.querySelector('input[name="unidade"]:checked').value === 'metric';
        let peso = parseFloat(document.getElementById('peso').value || '0');
        let altura = parseFloat(document.getElementById('altura').value || '0');
        const idade = parseInt(document.getElementById('idade').value || '0');
        const sexo = document.getElementById('sexo').value;
        const percentualGordura = parseFloat(document.getElementById('percentualGordura').value || '0');
        const nivelAtividade = document.getElementById('atividade').value;
        const objetivo = document.getElementById('objetivo').value;

        // 1.1 Conversão de Imperial para Métrico se necessário (para cálculo)
        if (!isMetric) {
            peso = peso / CONVERSAO_KG_LB; 
            altura = altura * CONVERSAO_IN_CM;
        }

        // 2. Validação dos dados OBRIGATÓRIOS
        if (peso <= 0 || altura <= 0 || idade <= 0 || sexo === '' || nivelAtividade === '' || objetivo === '') {
             alert('Por favor, preencha todos os campos obrigatórios: Peso, Altura, Idade, Sexo, Nível de Atividade e Objetivo, com valores positivos.');
            return;
        }

        try {
            let tmbResultado = 0;
            let formulaUsada = '(Mifflin-St Jeor)';
            const percGorduraValido = percentualGordura > 0 && percentualGordura < 60;
            
            // 3. Calcular TMB (Prioriza Katch-McArdle)
            if (percGorduraValido) {
                tmbResultado = calcularTMBKatch(peso, percentualGordura);
                formulaUsada = '(Katch-McArdle - Baseada na Massa Magra)';
            }
            if (tmbResultado <= 0) { // Se Katch falhar ou for ignorada
                tmbResultado = calcularTMBMifflin(peso, altura, idade, sexo);
                if (!percGorduraValido) formulaUsada = '(Mifflin-St Jeor)'; 
                else if (tmbResultado > 0) formulaUsada += ' -> Retornando para Mifflin-St Jeor'; 
            }

            tmbResultado = Math.round(tmbResultado);

            if (tmbResultado <= 500) { // TMB muito baixa (erro de entrada)
                 throw new Error("O TMB calculado é muito baixo. Verifique os dados inseridos.");
            }

            // 4. Calcular GET
            const getResultado = Math.round(calcularGET(tmbResultado, nivelAtividade));

            // 5. Calcular Calorias por Objetivo
            const caloriasObjetivo = calcularCaloriasObjetivo(getResultado, objetivo);
            
            // 6. Calcular Macros
            const macros = calcularMacronutrientes(caloriasObjetivo, objetivo);


            // 7. Exibir resultados
            document.getElementById('formula-tmb-usada').textContent = formulaUsada;
            document.getElementById('tmb-resultado').textContent = tmbResultado.toLocaleString('pt-BR');
            document.getElementById('get-resultado').textContent = getResultado.toLocaleString('pt-BR');
            document.getElementById('objetivo-texto-final').textContent = getTextoObjetivo(objetivo);
            document.getElementById('calorias-objetivo').textContent = Math.round(caloriasObjetivo).toLocaleString('pt-BR');

            // Exibir Macros Dinâmicos
            document.getElementById('macro-titulo-proporcao').textContent = `Distribuição de Macronutrientes (${macros.proporcaoTexto})`;
            document.getElementById('prot-gramas').textContent = macros.protG.toLocaleString('pt-BR');
            document.getElementById('carb-gramas').textContent = macros.carbG.toLocaleString('pt-BR');
            document.getElementById('gord-gramas').textContent = macros.gordG.toLocaleString('pt-BR');
            
            document.getElementById('prot-perc-display').textContent = `Proteínas (${macros.protPerc}%)`;
            document.getElementById('carb-perc-display').textContent = `Carboidratos (${macros.carbPerc}%)`;
            document.getElementById('gord-perc-display').textContent = `Gorduras (${macros.gordPerc}%)`;
            
            document.getElementById('macro-total-kcal').textContent = `${macros.totalKcal.toLocaleString('pt-BR')} kcal`;
            
            document.getElementById('resultados').style.display = 'block';

        } catch (error) {
            alert('Falha no cálculo. Verifique os dados inseridos. Detalhe: ' + error.message);
        }
    }

    // Inicializa a página após o carregamento, garantindo que o DOM esteja pronto
    window.onload = function() {
        ajustarUnidades();
    };
</script>
</body>
</html>